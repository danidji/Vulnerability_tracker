# Checking the input form
def get_errors(data):

    errors = {}

    if len(data["title"]) < 2 or len(data["title"]) > 50 : 
        errors["title"] = "Veuillez inscrire un titre entre 1 et 50 caractères"
        
    if data["impact"] == None or data["impact"] == "default":
        errors["impact"] = "Veuillez selectionner une option"

    if data["exploitation"] == None or data["exploitation"] == "default":
        errors["exploitation"] = "Veuillez selectionner une option"

    return errors

# Transform impact field number to string
def return_impact(ind):

    dic_impact = {
        0: "Mineur",
        1: "Important",
        2: "Majeur",
        3: "Critique"
    }
    return dic_impact.get(ind,'default')

# Transform exploitation field number to string
def return_exploitation(ind): 
    dic_exploitation = {
        0: "Difficile",
        1: "Elevée",
        2: "Modérée",
        3: "Facile"
    }
    return dic_exploitation.get(ind,'default')

# Transform risk number to string
def return_risk(ind): 
    dic_risk = {
        0: "Mineur",
        1: "Important",
        2: "Majeur",
        3: "Critique"
    }
    return dic_risk.get(ind,'default')

# Transform all field to string
def prettier_data(data) : 
    print(data)
    vulnerability = {}

    vulnerability["title"] = data["title"]
    vulnerability["impact"] = return_impact(data["impact"])
    vulnerability["exploitation"] = return_exploitation(data["exploitation"])
    vulnerability["risk"] = return_risk(data["risk"])
    print(vulnerability)
    return vulnerability